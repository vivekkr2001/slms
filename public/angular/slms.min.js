(function(){angular.module("slmsApp",["ngRoute","ui.bootstrap"]);function e(e){e.when("/",{templateUrl:"about/about.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/teacher",{templateUrl:"teacher/teacher.view.html",controller:"courseListCtrl",controllerAs:"vm"}).when("/teacher/:courseid/",{templateUrl:"teacher/teacher.courseDetails.html",controller:"teacherCourseDetailCtrl",controllerAs:"vm"}).when("/student/",{templateUrl:"student/student.view.html",controller:"studentCourseListCtrl",controllerAs:"vm"}).when("/student/:courseid/",{templateUrl:"student/student.courseDetails.html",controller:"studentCourseDetailCtrl",controllerAs:"vm"}).when("/admin",{templateUrl:"admin/admin.view.html",controller:"adminCourseListCtrl",controllerAs:"vm"}).when("/admin/:courseid/",{templateUrl:"admin/admin.courseDetails.html",controller:"adminCourseDetailCtrl",controllerAs:"vm"}).when("/courses/:courseid/contents/:contentid",{templateUrl:"modal/contentDelete.view.html",controller:"contentModalCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/admin/register/teacher",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"})}angular.module("slmsApp").config(["$routeProvider",e])})();(function(){angular.module("slmsApp").service("authentication",e);e.$inject=["$window","$http","$location"];function e(r,t,o){var n=function(e){r.localStorage["slms-token"]=e};var a=function(){return r.localStorage["slms-token"]};login=function(e){return t.post("/api/login",e).success(function(e){n(e.token);if(e.role=="admin"){o.url("/admin")}else if(e.role=="teacher"){o.url("/teacher")}else{o.url("/student")}})};register=function(e){return t.post("/api/register",e)};logout=function(){r.localStorage.removeItem("slms-token");o.path("/")};var l=function(){var e=a();if(e){var t=JSON.parse(r.atob(e.split(".")[1]));return t.exp>Date.now()/1e3}else{return false}};var e=function(){if(l()){var e=a();var t=JSON.parse(r.atob(e.split(".")[1]));return{email:t.email,name:t.name}}};return{saveToken:n,getToken:a,login:login,register:register,logout:logout,isLoggedIn:l,currentUser:e}}})();(function(){angular.module("slmsApp").controller("registerCtrl",e);e.$inject=["$location","authentication"];function e(e,t){var r=this;r.pageHeader={title:"Create a new SLMS account"};if(e.path()=="/admin/register/teacher"){r.credentials={name:"",email:"",password:"",role:"teacher"}}else{r.credentials={name:"",email:"",password:"",role:"student"}}if(e.path()=="/admin/register/teacher"){r.returnPage="/admin/"}else{r.returnPage="/"}r.onSubmit=function(){r.formError="";if(!r.credentials.name||!r.credentials.email||!r.credentials.password){r.formError="All fields required, please try again";return false}else{r.doRegister()}};r.doRegister=function(){r.formError="";t.register(r.credentials).error(function(e){r.formError="Fill all the details Completely"}).then(function(){alert("You Have been registered.");e.path(r.returnPage)})}}})();angular.module("slmsApp").controller("loginCtrl",loginCtrl);loginCtrl.$inject=["$location","authentication"];function loginCtrl(e,t){var r=this;r.pageHeader={title:"SLMS"};r.credentials={email:"",password:""};r.returnPage=e.search().page||"/student";r.onSubmit=function(){r.formError="";if(!r.credentials.email||!r.credentials.password){r.formError="All fields required, please try again";return false}else{r.doLogin()}};r.doLogin=function(){r.formError="";t.login(r.credentials).error(function(e){r.formError=e}).then(function(){e.search("page",null)})}}(function(){angular.module("slmsApp").controller("navigationCtrl",e);e.$inject=["$location","authentication"];function e(e,t){var r=this;r.currentPath=e.path();r.isLoggedIn=t.isLoggedIn();r.currentUser=t.currentUser();r.logout=function(){t.logout()}}})();(function(){angular.module("slmsApp").service("slmsData",e);e.$inject=["$http","authentication"];function e(r,e){var t=function(){e:{t:"Bearer "+e.getToken()}return r.get("/api/courses/")};var o=function(e){return r.post("/api/courses/new",e)};var n=function(e){return r.get("/api/courses/"+e)};var a=function(e){return r.delete("/api/courses/"+e)};var l=function(e,t){return r.put("/api/courses/"+e,t)};return{getCourses:t,createCourse:o,readCourseById:n,deleteCourseById:a,updateCourseById:l}}})();(function(){angular.module("slmsApp").controller("courseListCtrl",e);e.$inject=["$scope","slmsData"];function e(t,e){var r=this;r.pageHeader={title:"SLMS",strapline:"Teacher section"};r.sidebar={content:"stdy adndld"};r.message="Fetching Courses";e.getCourses().success(function(e){r.message=e.length>0?"":"No Courses Alloted";r.data={courses:e}}).error(function(e){t.message="Sorry, something's gone wrong "})}})();(function(){angular.module("slmsApp").controller("studentCourseListCtrl",e);e.$inject=["$scope","slmsData"];function e(t,e){var r=this;r.pageHeader={title:"SLMS",strapline:"Student section"};r.sidebar={content:"Study Management portal"};r.message="Fetching Courses";e.getCourses().success(function(e){r.message=e.length>0?"":"No Courses Alloted";r.data={courses:e}}).error(function(e){t.message="Sorry, something's gone wrong "})}})();(function(){angular.module("slmsApp").controller("adminCourseListCtrl",e);e.$inject=["$scope","slmsData","$modal","$rootScope"];function e(t,e,o,n){var r=this;r.pageHeader={title:"SLMS",strapline:"Admin section"};r.sidebar={content:"Student learning portal"};r.message="Fetching Courses";e.getCourses().success(function(e){r.message=e.length>0?"":"No Courses Alloted";r.data={courses:e}}).error(function(e){t.message="Sorry, something's gone wrong "});r.popupCourseForm=function(){var e=o.open({templateUrl:"/modal/course/courseModal.view.html",controller:"courseModalCtrl as vm"})};r.updateCourse=function(e){var t=n;t.courseid=e;var r=o.open({templateUrl:"/modal/course/courseUpdate.view.html",controller:"courseModalCtrl as vm"})};r.deleteCourse=function(e){var t=n;t.courseid=e;var r=o.open({templateUrl:"/modal/course/courseDelete.view.html",controller:"courseModalCtrl as vm"})}}})();(function(){angular.module("slmsApp").controller("courseModalCtrl",e);e.$inject=["$modalInstance","$routeParams","slmsData","$rootScope"];function e(t,e,r,o){var n=this;n.courseid=o.courseid;n.formError="";r.readCourseById(n.courseid).success(function(e){n.data=e}).error(function(e){console.log(e)});n.doAddCourse=function(e){r.createCourse({name:e.name,description:e.description,learning:e.learning}).success(function(e){n.modal.close(e);window.location.reload()}).error(function(e){n.formError="Try Again!!, Error: "+e});return false};n.deleteCourse=function(e){r.deleteCourseById(e,n.courseid).success(function(){n.modal.close();window.location.reload()}).error(function(e){n.formError="Error in Deletion: "+e});return false};n.updateCourse=function(e,t){console.log("Update details: "+t);r.updateCourseById(e,t).success(function(){n.modal.close();window.location.reload()}).error(function(e){n.formError=e});return false};n.modal={close:function(e){t.close(e)},cancel:function(){t.dismiss("cancel")}};n.onSubmit=function(){n.formError="";if(!n.formData.name||!n.formData.description){n.formError="Name and file fields required, please try again";return false}else{n.doAddCourse(n.formData)}};n.onDelete=function(){n.deleteCourse(n.courseid,n.courseid)};n.onUpdate=function(){n.formError="";if(!n.formData1.name||!n.formData1.description){n.formError="Name and Description fields required, please try again";return false}else{n.updateCourse(n.courseid,n.formData1)}}}})();(function(){angular.module("slmsApp").service("contentData",e);e.$inject=["$http","authentication"];function e(o,e){var t=function(e){return o.get("/api/courses/"+e)};var r=function(e,t){return o.post("/api/courses/"+e+"/contents",t)};var n=function(e,t){return o.delete("/api/courses/"+e+"/contents/"+t)};var a=function(e,t){return o.get("/api/courses/"+e+"/contents/"+t)};var l=function(e,t,r){return o.put("/api/courses/"+e+"/contents/"+t,r)};e:{t:"Bearer "+e.getToken()}return{courseById:t,addContentById:r,deleteContentById:n,readContentById:a,updateContentById:l}}})();(function(){angular.module("slmsApp").controller("studentCourseDetailCtrl",e);e.$inject=["$routeParams","contentData"];function e(e,t){var r=this;r.courseid=e.courseid;t.courseById(r.courseid).success(function(e){r.data={course:e};r.pageHeader={title:e.name,strapline:"Student section"}}).error(function(e){console.log(e)})}})();(function(){angular.module("slmsApp").controller("adminCourseDetailCtrl",e);e.$inject=["$routeParams","$location","$modal","contentData","$rootScope"];function e(e,t,o,r,n){var a=this;a.courseid=e.courseid;a.currentPath=t.path();r.courseById(a.courseid).success(function(e){a.data={course:e};a.pageHeader={title:e.name,strapline:"Admin section"}}).error(function(e){console.log(e)});a.popupContentForm=function(){var e=o.open({templateUrl:"/modal/content/contentModal.view.html",controller:"contentModalCtrl as vm"})};a.updateContent=function(e){var t=n;t.id=e;var r=o.open({templateUrl:"/modal/content/contentUpdate.view.html",controller:"contentModalCtrl as vm"})};a.deleteContent=function(e){var t=n;t.id=e;var r=o.open({templateUrl:"/modal/content/contentDelete.view.html",controller:"contentModalCtrl as vm"})}}})();(function(){angular.module("slmsApp").controller("teacherCourseDetailCtrl",e);e.$inject=["$routeParams","contentData","$modal","$rootScope"];function e(e,t,o,n){var r=this;r.courseid=e.courseid;t.courseById(r.courseid).success(function(e){r.data={course:e};r.pageHeader={title:e.name,strapline:"Teacher section"}}).error(function(e){console.log(e)});r.popupContentForm=function(){var e=o.open({templateUrl:"/modal/content/contentModal.view.html",controller:"contentModalCtrl as vm"})};r.updateContent=function(e){var t=n;t.id=e;var r=o.open({templateUrl:"/modal/content/contentUpdate.view.html",controller:"contentModalCtrl as vm"})};r.deleteContent=function(e){var t=n;t.id=e;var r=o.open({templateUrl:"/modal/content/contentDelete.view.html",controller:"contentModalCtrl as vm"})}}})();(function(){angular.module("slmsApp").controller("contentModalCtrl",e);e.$inject=["$modalInstance","$routeParams","contentData","$rootScope","$http"];function e(t,e,o,r,n){var a=this;a.courseid=e.courseid;a.formError="";a.contentid=r.id;o.readContentById(a.courseid,a.contentid).success(function(e){a.data=e}).error(function(e){console.log(e)});a.doAddContent=function(e,t){o.addContentById(e,{name:t.name,link:t.link,details:t.details}).success(function(e){a.modal.close(e);window.location.reload()}).error(function(e){a.formError="Try Again!!"});return false};a.deleteContent=function(e,t){o.deleteContentById(e,a.contentid).success(function(){a.modal.close();window.location.reload()}).error(function(e){a.formError="Error in Deletion: "+e});return false};a.updateContent=function(e,t,r){console.log("Update details: "+r);o.updateContentById(e,t,r).success(function(){a.modal.close(r);window.location.reload()}).error(function(e){a.formError=e});return false};a.modal={close:function(e){t.close(e)},cancel:function(){t.dismiss("cancel")}};a.onSubmit=function(){a.formError="";if(!a.formData.name||!a.formData.link){a.formError="Name and file fields required, please try again";return false}else{a.doAddContent(a.courseid,a.formData)}};a.onDelete=function(){a.deleteContent(a.courseid,a.contentid)};a.onUpdate=function(){a.formError="";if(!a.formData1.name||!a.formData1.link){a.formError="Name and file fields required, please try again";return false}else{a.updateContent(a.courseid,a.contentid,a.formData1)}};a.onUpload=function(e){n.post("/upload",upload.single("file"),(e,t)=>{t.redirect("/")})}}})();(function(){function e(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric.template.html"}}angular.module("slmsApp").directive("footerGeneric",e)})();(function(){function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation.template.html",controller:"navigationCtrl as navvm"}}angular.module("slmsApp").directive("navigation",e)})();(function(){function e(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader.template.html"}}angular.module("slmsApp").directive("pageHeader",e)})();